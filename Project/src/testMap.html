<!DOCTYPE html>
<meta charset="utf-8">

<head>
    <title>Map</title>
    <style type="text/css">
		path:hover {
			fill: orange !important;
		}
		path.republicanClick {
			fill: red !important;
		}
		path.democratClick {
			fill: blue !important;
		}
		path.thirdClick {
			fill: green !important;
		}
    </style>
</head>

<body>
<script src="/home/askuhn/WebApp1/map/d3.min.js"></script>
<script src="/home/askuhn/WebApp1/map/topojson.min.js"></script>
<script src="/home/askuhn/WebApp1/map/datamaps.usa.min.js"></script>

  <h2>Map</h2>
  <form action="" id="partyForm">
	<input name="party" type="radio" value="R"> Republican 
	<input name="party" type="radio" value="D"> Democrat
	<input name="party" type="radio" value="T"> Third Party <br/><br/>
  </form>
 
	Republican: <input type="text" id="resultR"> &nbsp &nbsp Democrat: <input type="text" id="resultD"><br/><br/>
 
   <div id="container1" style="position: relative; width: 80%; max-height: 450px;"></div>
     
     <script>
       //basic map config with custom fills, mercator projection
      var map = new Datamap({
        scope: 'usa',
        element: document.getElementById('container1'),
        height: 500,
geographyConfig: {
  highlightOnHover: false, popupTemplate: function(geography, data) {
	return ['<div class="hoverinfo"><strong>', geography.properties.name + '<br>Electoral Votes: ', + data.electoralVotes, '</strong></div>'].join('')},
    highlightBorderWidth: 3
  },
  fills: {
  'Republican': '#CC4731',
  'Democrat': '#306596',
  'Heavy Democrat': '#667FAF',
  'Light Democrat': '#A9C0DE',
  'Heavy Republican': '#CA5E5B',
  'Light Republican': '#EAA9A8',
  defaultFill: '#EDDC4E'
},
				data:{
				  "AZ": {
					  "fillKey": "Republican",
					  "electoralVotes": 10
				  },
				  "CO": {
					  "fillKey": "Light Democrat",
					  "electoralVotes": 9
				  },
				  "DE": {
					  "fillKey": "Democrat",
					  "electoralVotes": 3
				  },
				  "FL": {
					  "fillKey": "UNDECIDED",
					  "electoralVotes": 27
				  },
				  "GA": {
					  "fillKey": "Republican",
					  "electoralVotes": 15
				  },
				  "HI": {
					  "fillKey": "Democrat",
					  "electoralVotes": 4
				  },
				  "ID": {
					  "fillKey": "Republican",
					  "electoralVotes": 4
				  },
				  "IL": {
					  "fillKey": "Democrat",
					  "electoralVotes": 21
				  },
				  "IN": {
					  "fillKey": "Republican",
					  "electoralVotes": 11
				  },
				  "IA": {
					  "fillKey": "Light Democrat",
					  "electoralVotes": 7
				  },
				  "KS": {
					  "fillKey": "Republican",
					  "electoralVotes": 6
				  },
				  "KY": {
					  "fillKey": "Republican",
					  "electoralVotes": 8
				  },
				  "LA": {
					  "fillKey": "Republican",
					  "electoralVotes": 9
				  },
				  "MD": {
					  "fillKey": "Democrat",
					  "electoralVotes": 10
				  },
				  "ME": {
					  "fillKey": "Democrat",
					  "electoralVotes": 4
				  },
				  "MA": {
					  "fillKey": "Democrat",
					  "electoralVotes": 12
				  },
				  "MN": {
					  "fillKey": "Democrat",
					  "electoralVotes": 10
				  },
				  "MI": {
					  "fillKey": "Democrat",
					  "electoralVotes": 17
				  },
				  "MS": {
					  "fillKey": "Republican",
					  "electoralVotes": 6
				  },
				  "MO": {
					  "fillKey": "Republican",
					  "electoralVotes": 11
				  },
				  "MT": {
					  "fillKey": "Republican",
					  "electoralVotes": 3
				  },
				  "NC": {
					  "fillKey": "Light Republican",
					  "electoralVotes": 15
				  },
				  "NE": {
					  "fillKey": "Republican",
					  "electoralVotes": 5
				  },
				  "NV": {
					  "fillKey": "Heavy Democrat",
					  "electoralVotes": 5
				  },
				  "NH": {
					  "fillKey": "Light Democrat",
					  "electoralVotes": 4
				  },
				  "NJ": {
					  "fillKey": "Democrat",
					  "electoralVotes": 15
				  },
				  "NY": {
					  "fillKey": "Democrat",
					  "electoralVotes": 31
				  },
				  "ND": {
					  "fillKey": "Republican",
					  "electoralVotes": 3
				  },
				  "NM": {
					  "fillKey": "Democrat",
					  "electoralVotes": 5
				  },
				  "OH": {
					  "fillKey": "UNDECIDED",
					  "electoralVotes": 20
				  },
				  "OK": {
					  "fillKey": "Republican",
					  "electoralVotes": 7
				  },
				  "OR": {
					  "fillKey": "Democrat",
					  "electoralVotes": 7
				  },
				  "PA": {
					  "fillKey": "Democrat",
					  "electoralVotes": 21
				  },
				  "RI": {
					  "fillKey": "Democrat",
					  "electoralVotes": 4
				  },
				  "SC": {
					  "fillKey": "Republican",
					  "electoralVotes": 8
				  },
				  "SD": {
					  "fillKey": "Republican",
					  "electoralVotes": 3
				  },
				  "TN": {
					  "fillKey": "Republican",
					  "electoralVotes": 11
				  },
				  "TX": {
					  "fillKey": "Republican",
					  "electoralVotes": 34
				  },
				  "UT": {
					  "fillKey": "Republican",
					  "electoralVotes": 5
				  },
				  "WI": {
					  "fillKey": "Democrat",
					  "electoralVotes": 10
				  },
				  "VA": {
					  "fillKey": "Light Democrat",
					  "electoralVotes": 13
				  },
				  "VT": {
					  "fillKey": "Democrat",
					  "electoralVotes": 33
				  },
				  "WA": {
					  "fillKey": "Democrat",
					  "electoralVotes": 11
				  },
				  "WV": {
					  "fillKey": "Republican",
					  "electoralVotes": 5
				  },
				  "WY": {
					  "fillKey": "Republican",
					  "electoralVotes": 3
				  },
				  "CA": {
					  "fillKey": "Democrat",
					  "electoralVotes": 55
				  },
				  "CT": {
					  "fillKey": "Democrat",
					  "electoralVotes": 7
				  },
				  "AK": {
					  "fillKey": "Republican",
					  "electoralVotes": 3
				  },
				  "AR": {
					  "fillKey": "Republican",
					  "electoralVotes": 6
				  },
				  "AL": {
					  "fillKey": "Republican",
					  "electoralVotes": 9
				  }
				},

	done: function handleDataMapClick(datamap) {
	  datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
		console.log("click");
		
		if(getRadioVal(document.getElementById('partyForm'), 'party') == "R")
		{
			this.classList.add('republicanClick');
			//console.log(map.options.data[geography]);
			//map.options.data[geography] = "Republican";
			console.log(geography.id);
			var new_fills = {
              [geography.id] : {
                fillKey: "Republican"
              }
            };
            datamap.updateChoropleth(new_fills);
		}
		else if(getRadioVal(document.getElementById('partyForm'), 'party') == "D") {
			this.classList.add('democratClick');
			//console.log(map.options.data[geography]);
			console.log(geography.id);
			var new_fills = {
              [geography.id] : {
                fillKey: "Democrat"
              }
            };
            datamap.updateChoropleth(new_fills);
		}
		else if(getRadioVal(document.getElementById('partyForm'), 'party') == "T") {
			this.classList.add('thirdClick');
		}
		
		var repubVotes = 0;
		var demVotes = 0;
		
		for (key in map.options.data) {
			//console.log("hit loop");
			//console.log(key);
			//console.log(map.options.data);
			//var data = {};
			//data[key] = "Neutral";
			//console.log(map.options.data);
			//console.log(map.options.data[key].electoralVotes);
			
			if(map.options.data[key].fillKey == "Republican" || map.options.data[key].fillKey == "Light Republican") {
				repubVotes = repubVotes + map.options.data[key].electoralVotes;
				//demVotes = demVotes - repubVotes;
				//repubVotes = 200;
			};
			if(map.options.data[key].fillKey == "Democrat" || map.options.data[key].fillKey == "Light Democrat") {
				demVotes = demVotes + map.options.data[key].electoralVotes;
				//repubVotes = repubVotes - demVotes;
			};	
			/*
			if(map.options.data[key].fillKey == "ThirdParty") {
				demVotes = demVotes + map.options.data[key].electoralVotes;
			};	
			*/			
			//console.log(data);
			//map.updateChoropleth(data);
		}
		console.log(repubVotes);
		console.log(demVotes);
		
		resultR.value=repubVotes;
		resultD.value=demVotes;
		
		//console.log(map.options.data[geography].fillKey);	

				});
        }
        
      });

function getRadioVal(form, name) {
    var val;
    // get list of radio buttons with specified name
    var radios = form.elements[name];
    
    // loop through list of radio buttons
    for (var i=0, len=radios.length; i<len; i++) {
        if ( radios[i].checked ) { // radio checked?
            val = radios[i].value; // if so, hold its value in val
            break; // and break out of for loop
        }
    }
    return val; // return value of checked radio or undefined if none checked
}

/*
function voteCount(datamap) {
            datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
                alert(geography.properties.name);
                
                for (key in map.options.data) {
					//console.log("hit loop");
					console.log(key);
					//console.log(map.options.data);
					//var data = {};
					//data[key] = "Neutral";
					console.log(data[key]);
					console.log(data);
					map.updateChoropleth(data);
				}
                
				console.log("hit indiana");
                map.updateChoropleth({
					"IN": {fillKey: "Democrat"},});
				});
        }
      });
      */

/*
    done: function(datamap) {
      datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
        var selectedGeo = {};
        selectedGeo[geography.id] = '#ED1ADF';
        datamap.updateChoropleth(selectedGeo);
      }
    };   
       
        done: function(datamap) {
      datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
        var selectedGeo = {};
        selectedGeo[geography.id] = '#ED1ADF';
        datamap.updateChoropleth(selectedGeo);
				});
        }
      });

        done: function(datamap) {
            datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
                alert(geography.properties.name);
                
                for (key in map.options.data) {
					//console.log("hit loop");
					console.log(key);
					//console.log(map.options.data);
					var data = {};
					data[key] = "Neutral";
					console.log(data[key]);
					console.log(data);
					map.updateChoropleth(data);
				}
                
				console.log("hit indiana");
                map.updateChoropleth({
					"IN": {fillKey: "Democrat"},});
				});
        }
      });
      
*/
     </script>
</body>
